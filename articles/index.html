<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>분석 아카이브 | 개미 백테스트 PRO</title>
  <meta name="description" content="개미 백테스트 PRO의 장기 투자 비교 분석 글 모음입니다.">
  <style>
    body { font-family: "Noto Sans KR", sans-serif; max-width: 920px; margin: 32px auto; padding: 0 16px; line-height: 1.75; color: #1f2937; }
    h1, h2 { color: #111827; }
    .meta { color: #6b7280; font-size: 14px; }
    .card { border: 1px solid #e5e7eb; border-radius: 12px; padding: 14px; margin: 10px 0; background: #fcfdff; }
    a { color: #111827; font-weight: 700; text-decoration: none; }
    a:hover { text-decoration: underline; }
    code { background: #f3f4f6; padding: 2px 6px; border-radius: 6px; }
  </style>
</head>
<body>
  <p><a href="/">← 메인으로 돌아가기</a></p>
  <h1>분석 아카이브</h1>
  <p class="meta">articles 폴더에 새 HTML 글 파일을 추가하면 이 목록에 자동 반영됩니다.</p>

  <div id="articleList"></div>

  <div class="card">
    <h2><a href="/articles/article-template.html">분석 글 템플릿</a></h2>
    <p>새 글 작성 시 이 템플릿을 복사해 제목/수치/해석만 채우면 됩니다.</p>
    <p class="meta">사용 팁: <code>articles/article-template.html</code> 복사 후 파일명을 변경하세요.</p>
  </div>

  <script>
    async function loadArticles() {
      const listEl = document.getElementById("articleList");
      listEl.innerHTML = '<p class="meta">목록 불러오는 중...</p>';

      try {
        const res = await fetch('/api/articles');
        if (!res.ok) throw new Error('API error');

        const json = await res.json();
        const items = Array.isArray(json?.items) ? json.items : [];

        if (!items.length) {
          listEl.innerHTML = '<div class="card"><h2>아직 게시된 분석 글이 없습니다.</h2><p>첫 번째 분석 글을 추가해보세요.</p></div>';
          return;
        }

        listEl.innerHTML = items
          .map((item) => `
            <div class="card">
              <h2><a href="${item.path}">${escapeHtml(item.title)}</a></h2>
              <p>${escapeHtml(item.description)}</p>
            </div>
          `)
          .join('');
      } catch (e) {
        listEl.innerHTML = '<div class="card"><h2>목록을 불러오지 못했습니다.</h2><p>/api/articles 응답을 확인해 주세요.</p></div>';
      }
    }

    function escapeHtml(s) {
      return String(s || '')
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#39;');
    }

    loadArticles();
  </script>
</body>
</html>
